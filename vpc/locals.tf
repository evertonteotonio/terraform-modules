data "aws_region" "current" {}
data "aws_caller_identity" "current" {}

locals {
  account_id = "${data.aws_caller_identity.current.account_id}"
  aws_region = "${data.aws_region.current.name}"
  az_count = "${var.az_count > 2 ? var.az_count : 2}"
  az_name = {
    "0" = "a"
    "1" = "b"
    "2" = "c"
    "3" = "d"
    "4" = "e"
    "5" = "f" # us-east-1 has 6 AZ 2018-07
    "6" = "g"
    "7" = "h"
    "8" = "i"
    "9" = "j"
    "10" = "k"
    "11" = "l"
    "12" = "m"
    "13" = "n"
    "14" = "o"
    "15" = "p"
    "16" = "q"
    "17" = "r"
    "18" = "s"
    "19" = "t"
    "20" = "u"
    "21" = "v"
    "22" = "w"
    "23" = "x"
    "24" = "y"
    "25" = "z"
  }
  cidr_block = "${var.cidr_block}"
  public_cidr = {
    "0" = "${replace(var.cidr_block, ".0.0/16", "")}.0.0/24"
    "1" = "${replace(var.cidr_block, ".0.0/16", "")}.10.0/24"
    "2" = "${replace(var.cidr_block, ".0.0/16", "")}.20.0/24"
    "3" = "${replace(var.cidr_block, ".0.0/16", "")}.30.0/24"
    "4" = "${replace(var.cidr_block, ".0.0/16", "")}.40.0/24"
    "5" = "${replace(var.cidr_block, ".0.0/16", "")}.50.0/24"
    "6" = "${replace(var.cidr_block, ".0.0/16", "")}.60.0/24"
    "7" = "${replace(var.cidr_block, ".0.0/16", "")}.70.0/24"
    "8" = "${replace(var.cidr_block, ".0.0/16", "")}.80.0/24"
    "9" = "${replace(var.cidr_block, ".0.0/16", "")}.90.0/24"
    "10" = "${replace(var.cidr_block, ".0.0/16", "")}.100.0/24"
    "11" = "${replace(var.cidr_block, ".0.0/16", "")}.110.0/24"
    "12" = "${replace(var.cidr_block, ".0.0/16", "")}.120.0/24"
    "13" = "${replace(var.cidr_block, ".0.0/16", "")}.130.0/24"
    "14" = "${replace(var.cidr_block, ".0.0/16", "")}.140.0/24"
    "15" = "${replace(var.cidr_block, ".0.0/16", "")}.150.0/24"
    "16" = "${replace(var.cidr_block, ".0.0/16", "")}.160.0/24"
    "17" = "${replace(var.cidr_block, ".0.0/16", "")}.170.0/24"
    "18" = "${replace(var.cidr_block, ".0.0/16", "")}.180.0/24"
    "19" = "${replace(var.cidr_block, ".0.0/16", "")}.190.0/24"
    "20" = "${replace(var.cidr_block, ".0.0/16", "")}.200.0/24"
    "21" = "${replace(var.cidr_block, ".0.0/16", "")}.210.0/24"
    "22" = "${replace(var.cidr_block, ".0.0/16", "")}.220.0/24"
    "23" = "${replace(var.cidr_block, ".0.0/16", "")}.230.0/24"
    "24" = "${replace(var.cidr_block, ".0.0/16", "")}.240.0/24"
    "25" = "${replace(var.cidr_block, ".0.0/16", "")}.250.0/24"
  }
  private_cidr = {
    "0" = "${replace(var.cidr_block, ".0.0/16", "")}.1.0/24"
    "1" = "${replace(var.cidr_block, ".0.0/16", "")}.11.0/24"
    "2" = "${replace(var.cidr_block, ".0.0/16", "")}.21.0/24"
    "3" = "${replace(var.cidr_block, ".0.0/16", "")}.31.0/24"
    "4" = "${replace(var.cidr_block, ".0.0/16", "")}.41.0/24"
    "5" = "${replace(var.cidr_block, ".0.0/16", "")}.51.0/24"
    "6" = "${replace(var.cidr_block, ".0.0/16", "")}.61.0/24"
    "7" = "${replace(var.cidr_block, ".0.0/16", "")}.71.0/24"
    "8" = "${replace(var.cidr_block, ".0.0/16", "")}.81.0/24"
    "9" = "${replace(var.cidr_block, ".0.0/16", "")}.91.0/24"
    "10" = "${replace(var.cidr_block, ".0.0/16", "")}.101.0/24"
    "11" = "${replace(var.cidr_block, ".0.0/16", "")}.111.0/24"
    "12" = "${replace(var.cidr_block, ".0.0/16", "")}.121.0/24"
    "13" = "${replace(var.cidr_block, ".0.0/16", "")}.131.0/24"
    "14" = "${replace(var.cidr_block, ".0.0/16", "")}.141.0/24"
    "15" = "${replace(var.cidr_block, ".0.0/16", "")}.151.0/24"
    "16" = "${replace(var.cidr_block, ".0.0/16", "")}.161.0/24"
    "17" = "${replace(var.cidr_block, ".0.0/16", "")}.171.0/24"
    "18" = "${replace(var.cidr_block, ".0.0/16", "")}.181.0/24"
    "19" = "${replace(var.cidr_block, ".0.0/16", "")}.191.0/24"
    "20" = "${replace(var.cidr_block, ".0.0/16", "")}.201.0/24"
    "21" = "${replace(var.cidr_block, ".0.0/16", "")}.211.0/24"
    "22" = "${replace(var.cidr_block, ".0.0/16", "")}.221.0/24"
    "23" = "${replace(var.cidr_block, ".0.0/16", "")}.231.0/24"
    "24" = "${replace(var.cidr_block, ".0.0/16", "")}.241.0/24"
    "25" = "${replace(var.cidr_block, ".0.0/16", "")}.251.0/24"
  }
}
